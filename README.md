## Бот продаж подписок для конфигураций 3X-UI

Этот проект реализует Telegram‑бота для продажи VPN‑подписок через API панели 3X‑UI.

Бот позволяет:

- Получить тестовую (пробную) VPN‑подписку  
- Оформить подписку на разный срок  
- Продлить уже существующую подписку  
- Посмотреть текущий статус подписки  
- Получить поддержку и инструкции по настройке VPN для разных платформ

## Основные модули

В проекте используются стандартные и сторонние библиотеки Python, среди которых:

- `logging` — логирование сообщений  
- `requests` — HTTP‑запросы к VPN API  
- `json` — работа с JSON‑данными  
- `time` — функции работы со временем  
- `sqlite3` — работа с базой данных SQLite  
- `random`, `string` — генерация случайных строк (идентификаторов и т.п.)  
- `threading` — запуск периодических задач в отдельных потоках  
- `uuid` — генерация уникальных идентификаторов  
- `datetime` — работа с датой и временем  
- `telegram`, `telegram.ext` — взаимодействие с Telegram Bot API и обработка команд/коллбеков

## Основные функции бота

- `vpn_login` — авторизация в панели 3X‑UI и сохранение сессии  
- `periodic_session_refresh` — периодическое обновление VPN‑сессии  
- `init_db` — инициализация базы данных SQLite и создание таблицы клиентов  
- `add_client_to_db` — добавление нового клиента  
- `update_client_expiry` — обновление срока действия подписки клиента  
- `get_client_by_tg_id` — получение последней подписки по Telegram ID пользователя  
- `get_all_user_subscriptions` — получение всех подписок пользователя  
- `is_subscription_active` — проверка, активна ли подписка по времени окончания  
- `generate_sub_id` — генерация случайного идентификатора подписки  
- `get_subscription_display` — человекочитаемое название типа подписки  
- `support_command` — отправка пользователю сообщения поддержки  
- `is_user_subscribed` — проверка подписки пользователя на необходимый Telegram‑канал  
- `subscription_command` — показ текущего статуса подписки  
- `test_command` — выдача пробной подписки на 24 часа  
- `subscribe_command` — старт процесса покупки подписки и выбор тарифа  
- `extend_command` — старт процесса продления подписки  
- `confirm_payment_command` — подтверждение оплаты и уведомление администратора  
- `cancel_payment_command` — отмена ожидающего платежа  
- `subscribe_with_duration` — создание подписки на выбранный срок и отправка реквизитов оплаты  
- `extend_with_duration` — создание продления подписки и отправка реквизитов оплаты  
- `approve_payment` — подтверждение оплаты и активация подписки  
- `reject_payment` — отклонение платежа  
- `show_instructions_menu` — показ меню с инструкциями для разных платформ  
- `show_instruction_text` — вывод текста инструкции по выбранной платформе  
- `start_command` — главное меню и стартовое сообщение  
- `callback_handler` — обработка inline‑кнопок  
- `main` — инициализация БД, вход в VPN‑панель и запуск Telegram‑бота

